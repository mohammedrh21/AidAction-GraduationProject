@page "/MainWebsite/DonationCenter"
@layout MainLayout
@inject IJSRuntime JS
@inject NavigationManager _Nav
@inject IMainWebsite _Main
<PageTitle>DonationCenter</PageTitle>

<!-- Donation Center Section -->
<div class="container my-5">
    <div class="section-wrapper">
        <!-- 🔸 Top Row: Description Left, Actions Right -->
        <div class="row g-4 align-items-start">
            <!-- Left: Text Description -->
            <div class="col-lg-6">
                <span class="badge bg-light text-dark mb-2">Donation Center</span>
                <h2 class="fw-bold text-dark mb-3">Choose How You Want to Give</h2>
                <p class="text-muted">
                    Empower a life, support a cause, and be the change. Your donation
                    matters more than ever. Choose how you'd like to donate and make a
                    difference today. Your generosity empowers real impact.
                </p>
            </div>

            <!-- Right: Donate Now & Campaign Options -->
            <div class="col-lg-6">
                <div class="row g-3">
                    <!-- Quick Donation Card -->
                    <div class="col-md-6">
                        <div class="highlight-card text-center">
                            <div class="stats-card">Quick Donation</div>
                            <p class="text-muted mb-2">
                                Support instantly with one click.
                            </p>

                            <a href="Payment-page.html"
                               style="text-decoration: none; color: #343a40">
                               
                                <NavLink href="@GetDonateUrl()" style="margin-top: 15px" class="btn btn-success w-100">
                                    Donate Now
                                </NavLink>
                            </a>
                        </div>
                    </div>
                    <!-- Campaign Donation Card -->
                    <div class="col-md-6">
                        <div class="highlight-card text-center">
                            <div class="stats-card">Campaign Support</div>
                            <p class="text-muted mb-2" style="font-size: small">
                                Pick a cause that speaks to you.
                            </p>
                            <button class="btn btn-outline w-100" style="margin-top: 8px">
                                <NavLink href="/MainWebsite/FundraiserCampaigns"
                                   style="text-decoration: none; color: black">View Campaigns</NavLink>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 🔸 Bottom Row: Image Left, IBAN Flip Card Right -->
        <div class="row g-4 align-items-center mt-4">
            <!-- Image taking 3/4 of width -->
            <div class="col-lg-9">
                <img src="./resources/images/donateCenterImg.png"
                     class="img-fluid rounded w-100"
                     alt="Donation Scene"
                     style="background-color: #343a40" />
            </div>
            <div class="col-lg-3">
                <div class="flip-card">
                    <div class="flip-card-inner">
                        <!-- Front Side -->
                        <div class="flip-card-front d-flex flex-column justify-content-center align-items-center">
                            <div class="stats-card">Donate via Bank Transfer</div>
                            <p class="text-muted mb-2" style="font-size: small">
                                Choose the option you prefer.
                            </p>
                            <i class="fas fa-sync-alt fa-2x text-muted mt-2"
                               style="font-size: smaller"></i>
                            <button class="btn btn-outline w-100 mt-2">
                                Flip to get our IBAN
                            </button>
                        </div>

                        <!-- Back Side -->
                        <div class="flip-card-back d-flex flex-column justify-content-center align-items-center">
                            <h5 class="text-success mb-3">Our IBAN</h5>
                            <p class="fw-bold text-dark text-center" id="iban-text">
                                @website.IBAN
                            </p>
                            <button class="btn btn-secondary btn-sm mt-2"
                                    onclick="copyIBAN(this)">
                                Copy IBAN
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@code {
    public WebsiteDetails website { get; set; } = new WebsiteDetails();

    protected override async Task OnInitializedAsync()
    {
        await WebsiteDetailsSelectAsync();
    }

    public async Task WebsiteDetailsSelectAsync()
    {

        var result = await _Main.WebsiteDetailsSelectAsync();
        var resultDataList = Newtonsoft.Json.JsonConvert.DeserializeObject<List<Result<List<WebsiteDetails>>>>(result.ToString());

        // Get the first item from the list (since it’s an array in the JSON root)
        var resultData = resultDataList.FirstOrDefault();

        // Check if the result is not null
        if (resultData != null)
        {
            // Access the list of WebsiteDetails
            List<WebsiteDetails> websiteDetailsList = resultData.Data;
            website = websiteDetailsList.FirstOrDefault();
        }
        StateHasChanged(); // Trigger re-render to update UI with the new data
    }

    private string GetDonateUrl()
    {
        return $"/MainWebsite/Donate/";
    }
}